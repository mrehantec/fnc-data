import streamlit as st
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy.interpolate import PchipInterpolator

st.title("Calcolatore FNC Family – Risultati Operativi")

# ==============================================================================
# 1) Dati fancoil misurati (q_c, q_h sono in m³/h)
# ==============================================================================
fnc_data = {
    "FNC THIN": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.0, 4.0, 5.7],
                "q_c": [0.081, 0.165, 0.236],
                "Ps":  [0.37, 0.77, 1.13],
                "Pc":  [0.47, 0.95, 1.34],
                "Pec": [2.3, 11.2, 36.7],
                "Dpc": [9.1, 10.82, 12.71]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.0, 4.0, 5.7],
                "q_h": [0.086, 0.195, 0.279],
                "Ph":  [0.50, 1.14, 1.64],
                "PeH": [2.1, 11.3, 37.0],
                "Dph": [8.4, 10.47, 12.97]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 2200],
                "vsp": [2.0, 4.0, 7.0],
                "q_c": [0.084, 0.181, 0.322],
                "Ps":  [0.41, 0.88, 1.57],
                "Pc":  [0.49, 1.05, 1.80],
                "Pec": [2.20, 12.20, 78.80],
                "Dpc": [11.31, 13.47, 14.38]
            },
            "Heating": {
                "rpm": [500, 1200, 2200],
                "vsp": [2.0, 4.0, 7.0],
                "q_h": [0.089, 0.219, 0.367],
                "Ph":  [0.52, 1.27, 2.19],
                "PeH": [2.0, 12.50, 80.50],
                "Dph": [6.87, 10.65, 15.11]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.0, 4.0, 5.7],
                "q_c": [0.16, 0.403, 0.572],
                "Ps":  [0.85, 2.10, 3.00],
                "Pc":  [0.93, 2.33, 3.25],
                "Pec": [4.20, 25.10, 88.30],
                "Dpc": [6.74, 14.46, 23.34]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.0, 4.0, 5.7],
                "q_h": [0.186, 0.467, 0.661],
                "Ph":  [1.08, 2.71, 3.89],
                "PeH": [4.20, 26.30, 87.50],
                "Dph": [7.03, 16.35, 26.79]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 2150],
                "vsp": [2.0, 4.0, 6.9],
                "q_c": [0.121, 0.302, 0.592],
                "Ps":  [0.59, 1.53, 2.84],
                "Pc":  [0.70, 1.74, 3.32],
                "Pec": [3.70, 22.80, 129.40],
                "Dpc": [5.77, 7.94, 4.81]
            },
            "Heating": {
                "rpm": [500, 1200, 2150],
                "vsp": [2.0, 4.0, 6.9],
                "q_h": [0.139, 0.398, 0.691],
                "Ph":  [0.81, 2.32, 4.10],
                "PeH": [3.80, 22.40, 128.70],
                "Dph": [5.63, 10.08, 4.86]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.0, 4.0, 5.7],
                "q_c": [0.179, 0.489, 0.717],
                "Ps":  [0.93, 2.48, 3.58],
                "Pc":  [1.04, 2.81, 4.04],
                "Pec": [5.80, 40.00, 134.40],
                "Dpc": [6.08, 15.89, 28.71]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.0, 4.0, 5.7],
                "q_h": [0.23, 0.635, 0.909],
                "Ph":  [1.33, 3.69, 5.36],
                "PeH": [5.90, 39.50, 136.70],
                "Dph": [7.14, 22.78, 41.17]
            }
        }
    },
    "FNC THIN MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1950],
                "vsp": [2.0, 4.0, 6.43],
                "q_c": [0.137, 0.375, 0.539],
                "Ps":  [0.41, 0.881, 0.485],
                "Pc":  [0.485, 1.048, 3.06],
                "Pec": [2.2, 12.2, 79.7],
                "Dpc": [11.31, 13.47, 36.25]
            },
            "Heating": {
                "rpm": [500, 1200, 1950],
                "vsp": [2.0, 4.0, 6.43],
                "q_h": [0.137, 0.375, 0.577],
                "Ph":  [0.79, 2.17, 3.39],
                "PeH": [3.4, 17.5, 71.4],
                "Dph": [6.95, 15.95, 35.44]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.0, 4.0, 6.58],
                "q_c": [0.191, 0.493, 0.782],
                "Ps":  [0.87, 2.28, 1.10],
                "Pc":  [1.10, 2.84, 4.42],
                "Pec": [5.6, 24.6, 135.3],
                "Dpc": [6.84, 16.72, 42.66]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.0, 4.0, 6.58],
                "q_h": [0.23, 0.524, 0.873],
                "Ph":  [1.32, 3.03, 5.14],
                "PeH": [5.5, 24.3, 125.0],
                "Dph": [7.9, 16.91, 45.12]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 1950],
                "vsp": [2.0, 4.0, 6.3],
                "q_c": [0.219, 0.649, 0.986],
                "Ps":  [1.03, 2.93, 1.27],
                "Pc":  [1.27, 3.75, 5.61],
                "Pec": [7.5, 35.7, 140.4],
                "Dpc": [6.49, 22.05, 37.35]
            },
            "Heating": {
                "rpm": [500, 1200, 1950],
                "vsp": [2.0, 4.0, 6.3],
                "q_h": [0.23, 0.696, 1.081],
                "Ph":  [1.33, 4.04, 6.36],
                "PeH": [6.3, 35.7, 133.1],
                "Dph": [5.6, 23.81, 41.07]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 2500],
                "vsp": [2.2, 4.0, 7.91],
                "q_c": [0.205, 0.551, 1.007],
                "Ps":  [0.97, 2.77, 1.19],
                "Pc":  [1.19, 3.18, 5.93],
                "Pec": [8.9, 42.8, 344.0],
                "Dpc": [5.78, 12.69, 23.55]
            },
            "Heating": {
                "rpm": [500, 1200, 2500],
                "vsp": [2.2, 4.0, 7.91],
                "q_h": [0.256, 0.657, 1.283],
                "Ph":  [1.49, 3.82, 6.70],
                "PeH": [8.9, 41.7, 338.0],
                "Dph": [6.4, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    },
    "FNC MULTI": {
        "600/2": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.249, 0.568, 0.645],
                "Ps":  [1.11, 2.75, 1.45],
                "Pc":  [1.45, 3.32, 3.79],
                "Pec": [5.2, 38.6, 65.5],
                "Dpc": [10.25, 30.31, 36.36]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.267, 0.622, 0.722],
                "Ph":  [1.55, 3.59, 4.14],
                "PeH": [5.4, 38.2, 64.6],
                "Dph": [13.68, 30.8, 39.15]
            }
        },
        "800/3": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_c": [0.331, 0.715, 0.999],
                "Ps":  [1.53, 3.46, 1.93],
                "Pc":  [1.93, 4.17, 5.54],
                "Pec": [7.9, 58.6, 281.2],
                "Dpc": [10.88, 32.02, 62.67]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.04],
                "q_h": [0.366, 0.808, 1.163],
                "Ph":  [2.10, 4.64, 6.94],
                "PeH": [8.1, 55.8, 273.1],
                "Dph": [11.13, 36.52, 74.65]
            }
        },
        "1000/4": {
            "Cooling": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_c": [0.344, 0.899, 1.281],
                "Ps":  [1.77, 4.49, 1.27],
                "Pc":  [2.06, 5.23, 7.14],
                "Pec": [10.5, 68.4, 345.0],
                "Dpc": [7.24, 15.16, 20.36]
            },
            "Heating": {
                "rpm": [500, 1200, 2050],
                "vsp": [2.2, 4.5, 7.06],
                "q_h": [0.455, 1.062, 4.598],
                "Ph":  [2.61, 6.10, 9.58],
                "PeH": [10.5, 66.9, 357.1],
                "Dph": [6.45, 14.08, 25.97]
            }
        },
        "1200/5": {
            "Cooling": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_c": [0.448, 1.144, 1.328],
                "Ps":  [2.19, 5.68, 2.60],
                "Pc":  [2.60, 6.72, 7.73],
                "Pec": [14.6, 97.4, 168.6],
                "Dpc": [6.9, 25.48, 32.52]
            },
            "Heating": {
                "rpm": [500, 1200, 1500],
                "vsp": [2.2, 4.5, 5.3],
                "q_h": [0.57, 1.338, 1.565],
                "Ph":  [3.27, 7.68, 8.94],
                "PeH": [14.0, 95.1, 160.8],
                "Dph": [8.54, 17.49, 26.89]
            }
        }
    },
    "FNC": {
        "400": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.143, 0.394, 0.504],
                "Ps":  [0.68, 2.05, 2.76],
                "Pc":  [0.83, 2.29, 2.94],
                "Pec": [2.8, 38.9, 122.0],
                "Dpc": [11.89, 12.0, 17.57]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.127, 0.5, 0.63],
                "Ph":  [0.74, 2.87, 3.62],
                "PeH": [2.0, 42.0, 124.0],
                "Dph": [4.97, 16.95, 26.04]
            }
        },
        "600": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.176, 0.502, 0.616],
                "Ps":  [0.85, 2.48, 3.17],
                "Pc":  [1.02, 2.93, 3.60],
                "Pec": [2.8, 47.5, 121.5],
                "Dpc": [7.39, 24.46, 33.11]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.205, 0.579, 0.724],
                "Ph":  [1.19, 3.34, 4.17],
                "PeH": [2.8, 47.5, 121.5],
                "Dph": [7.86, 26.38, 44.35]
            }
        },
        "800": {
            "Cooling": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_c": [0.229, 0.774, 0.865],
                "Ps":  [1.08, 3.72, 4.25],
                "Pc":  [1.33, 4.45, 4.97],
                "Pec": [4.2, 56.1, 89.6],
                "Dpc": [7.44, 36.42, 43.6]
            },
            "Heating": {
                "rpm": [500, 1100, 1260],
                "vsp": [2.2, 5.1, 5.9],
                "q_h": [0.285, 0.906, 1.035],
                "Ph":  [1.63, 5.27, 6.04],
                "PeH": [4.3, 55.0, 91.9],
                "Dph": [8.19, 35.86, 47.54]
            }
        },
        "1000": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.279, 0.866, 1.057],
                "Ps":  [1.45, 4.48, 5.60],
                "Pc":  [1.65, 5.04, 6.16],
                "Pec": [6.4, 99.6, 230.9],
                "Dpc": [5.57, 12.12, 15.8]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.424, 1.14, 1.353],
                "Ph":  [2.43, 6.57, 7.75],
                "PeH": [7.0, 103.2, 233.5],
                "Dph": [12.19, 19.92, 22.72]
            }
        },
        "1200": {
            "Cooling": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_c": [0.367, 1.24, 1.521],
                "Ps":  [1.84, 6.18, 8.06],
                "Pc":  [2.14, 7.17, 8.89],
                "Pec": [8.7, 130.8, 362.9],
                "Dpc": [10.86, 25.54, 33.09]
            },
            "Heating": {
                "rpm": [500, 1200, 1800],
                "vsp": [2.2, 5.8, 9.0],
                "q_h": [0.503, 1.471, 1.852],
                "Ph":  [2.89, 8.54, 10.64],
                "PeH": [8.5, 129.9, 367.7],
                "Dph": [8.44, 25.63, 35.06]
            }
        }
    }
}

# ==============================================================================
# 14) Funzione per determinare il numero di ventilatori
# ==============================================================================
def get_ventilator_count(version, model):
    if version in ["FNC THIN", "FNC"]:
        if model in ["400", "600"]:
            return 1
        elif model in ["800", "1000"]:
            return 2
        elif model == "1200":
            return 3
    elif version in ["FNC THIN MULTI", "FNC MULTI"]:
        try:
            return int(model.split("/")[1])
        except Exception:
            return 1
    return 1
    
fan_curves = {
    ("FNC THIN", "400"): {"rpm": [500, 1200, 1800], "air_flow": [200, 450, 680]},
    ("FNC THIN", "600"): {"rpm": [500, 1200, 2200], "air_flow": [240, 480, 720]},
    ("FNC THIN", "800"): {"rpm": [500, 1200, 1800], "air_flow": [250, 500, 750]},
    ("FNC THIN", "1000"): {"rpm": [500, 1200, 2150], "air_flow": [300, 550, 800]},
    ("FNC THIN", "1200"): {"rpm": [500, 1200, 1800], "air_flow": [350, 600, 850]},
    
    ("FNC", "400"): {"rpm": [500, 1200, 1800], "air_flow": [210, 460, 690]},
    ("FNC", "600"): {"rpm": [500, 1200, 1800], "air_flow": [250, 500, 750]},
    ("FNC", "800"): {"rpm": [500, 1100, 1260], "air_flow": [250, 500, 750]},
    ("FNC", "1000"): {"rpm": [500, 1200, 1800], "air_flow": [300, 550, 800]},
    ("FNC", "1200"): {"rpm": [500, 1200, 1800], "air_flow": [350, 600, 850]},
    
    ("FNC THIN MULTI", "600/2"): {"rpm": [500, 1200, 1950], "air_flow": [250, 500, 750]},
    ("FNC THIN MULTI", "800/3"): {"rpm": [500, 1200, 2050], "air_flow": [250, 500, 750]},
    ("FNC THIN MULTI", "1000/4"): {"rpm": [500, 1200, 1950], "air_flow": [300, 550, 800]},
    ("FNC THIN MULTI", "1200/5"): {"rpm": [500, 1200, 2500], "air_flow": [350, 600, 850]},
    
    ("FNC MULTI", "600/2"): {"rpm": [500, 1200, 1500], "air_flow": [250, 500, 750]},
    ("FNC MULTI", "800/3"): {"rpm": [500, 1200, 2050], "air_flow": [250, 500, 750]},
    ("FNC MULTI", "1000/4"): {"rpm": [500, 1200, 2050], "air_flow": [300, 550, 800]},
    ("FNC MULTI", "1200/5"): {"rpm": [500, 1200, 1500], "air_flow": [350, 600, 850]}
}
# ==============================================================================
# 15) Funzioni di interpolazione
# ==============================================================================
def safe_extrap_rpm(rpm_input, rpm_arr, val_arr):
    f = PchipInterpolator(rpm_arr, val_arr, extrapolate=False)
    rmin, rmax = rpm_arr[0], rpm_arr[-1]
    if rpm_input <= rmin:
        return val_arr[0]
    elif rpm_input >= rmax:
        slope = (val_arr[-1] - val_arr[-2]) / (rmax - rpm_arr[-2])
        return val_arr[-1] + slope * (rpm_input - rmax)
    else:
        return f(rpm_input)

def safe_extrap_vsp(vsp_input, vsp_arr, rpm_arr):
    f = PchipInterpolator(vsp_arr, rpm_arr, extrapolate=False)
    vmin, vmax = vsp_arr[0], vsp_arr[-1]
    if vsp_input <= vmin:
        return rpm_arr[0]
    elif vsp_input >= vmax:
        slope = (rpm_arr[-1] - rpm_arr[-2]) / (vmax - vsp_arr[-2])
        return rpm_arr[-1] + slope * (vsp_input - vmax)
    else:
        return f(vsp_input)

def get_air_flow(rpm_input, version, model, p_static):
    key = (version, model)
    if key not in fan_curves:
        return 0.0
    fc = fan_curves[key]
    rpmA = np.array(fc["rpm"], dtype=float)
    afA  = np.array(fc["air_flow"], dtype=float)
    f_interp = PchipInterpolator(rpmA, afA, extrapolate=False)
    rmin, rmax = rpmA[0], rpmA[-1]
    if rpm_input <= rmin:
        slope = (afA[1] - afA[0]) / (rpmA[1] - rpmA[0])
        val = afA[0] + slope * (rpm_input - rmin)
    elif rpm_input >= rmax:
        slope = (afA[-1] - afA[-2]) / (rpmA[-1] - rpmA[-2])
        val = afA[-1] + slope * (rpm_input - rmax)
    else:
        val = float(f_interp(rpm_input))
    # Correzione per pressione statica: ogni Pa riduce la portata aria dello 0.1%
    corr = 1 - 0.001 * p_static
    if corr < 0:
        corr = 0
    return val * corr

# ==============================================================================
# 16) Selezione delle condizioni operative (ΔT base)
# ==============================================================================
cooling_conditions = {"7-12": 5, "8-13": 5, "10-15": 5, "12-17": 5}
heating_conditions = {"70-60": 10, "60-50": 10, "50-40": 10, "45-40": 5, "40-35": 5, "35-30": 5}

if st.selectbox("Modalità", ["Cooling", "Heating"]) == "Cooling":
    mode = "Cooling"
    conditions = cooling_conditions
    delta_t_base = 5
else:
    mode = "Heating"
    conditions = heating_conditions
    delta_t_base = 10

# ==============================================================================
# 17) Selezione Versione e Modello
# ==============================================================================
col_ver, col_mod = st.columns(2)
with col_ver:
    version_list = list(fnc_data.keys())
    version_sel = st.selectbox("Versione", version_list)
with col_mod:
    model_list = list(fnc_data[version_sel].keys())
    model_sel = st.selectbox("Modello", model_list)

n_fan = get_ventilator_count(version_sel, model_sel)
st.write(f"**Numero Ventilatori:** {n_fan}")

try:
    data_mode = fnc_data[version_sel][model_sel][mode]
except KeyError:
    st.error("Dati mancanti per questa combinazione (Versione, Modello, Modalità).")
    st.stop()

rpm_arr = np.array(data_mode["rpm"], dtype=float)
vsp_arr = np.array(data_mode["vsp"], dtype=float)

# ==============================================================================
# 18) Metodo di inserimento: RPM o Vsp
# ==============================================================================
method = st.radio("Metodo di inserimento", ["Inserisci RPM", "Inserisci Vsp"])
if method == "Inserisci RPM":
    rpm_in = st.number_input("Inserisci RPM", min_value=int(rpm_arr[0]), max_value=int(rpm_arr[-1]), value=int(rpm_arr[0]), step=1)
else:
    vmin, vmax = float(vsp_arr[0]), float(vsp_arr[-1])
    vsp_in = st.slider("Seleziona Vsp (Volt)", vmin, vmax, vmin, 0.1)
    rpm_in = safe_extrap_vsp(vsp_in, vsp_arr, rpm_arr)
    st.write(f"**RPM calcolati**: {rpm_in:.0f}")

# ==============================================================================
# 19) Input Temperature e Pressione Statica
# ==============================================================================
if mode == "Cooling":
    default_t_in, default_t_out = 7.0, 12.0
else:
    default_t_in, default_t_out = 70.0, 60.0

colT1, colT2, colP = st.columns(3)
with colT1:
    t_in = st.number_input("Temp. ingresso acqua (°C)", value=default_t_in, step=0.5)
with colT2:
    t_out = st.number_input("Temp. uscita acqua (°C)", value=default_t_out, step=0.5)
with colP:
    p_stat = st.number_input("Pressione statica (Pa)", min_value=0.0, max_value=200.0, value=0.0, step=5.0)

if mode == "Cooling" and t_in >= t_out:
    st.error("In Cooling, T_in deve essere < T_out.")
    st.stop()
elif mode == "Heating" and t_in < t_out:
    st.error("In Heating, T_in deve essere >= T_out.")
    st.stop()

delta_t_in = abs(t_in - t_out)
st.subheader(f"Calcolo parametri a RPM={rpm_in:.0f} – Modalità: {mode}")

# ==============================================================================
# 20) Interpolazione dei parametri del fancoil
# ==============================================================================
def get_val(key):
    return np.array(data_mode[key], dtype=float)

if mode == "Cooling":
    qc = get_val("q_c")
    ps = get_val("Ps")
    pc = get_val("Pc")
    pec = get_val("Pec")
    dpc = get_val("Dpc")
    qc_in_val = safe_extrap_rpm(rpm_in, rpm_arr, qc)
    ps_in_val = safe_extrap_rpm(rpm_in, rpm_arr, ps)
    pc_in_val = safe_extrap_rpm(rpm_in, rpm_arr, pc)
    if pc_in_val < ps_in_val:
        pc_in_val = ps_in_val
    lat_in_val = pc_in_val - ps_in_val
    pec_in_val = safe_extrap_rpm(rpm_in, rpm_arr, pec)
    dpc_in_val = safe_extrap_rpm(rpm_in, rpm_arr, dpc)
    water_flow = qc_in_val * n_fan * (delta_t_in / delta_t_base)
else:
    qh = get_val("q_h")
    ph = get_val("Ph")
    peh = get_val("PeH")
    dph = get_val("Dph")
    qh_in_val = safe_extrap_rpm(rpm_in, rpm_arr, qh)
    ph_in_val = safe_extrap_rpm(rpm_in, rpm_arr, ph)
    peh_in_val = safe_extrap_rpm(rpm_in, rpm_arr, peh)
    dph_in_val = safe_extrap_rpm(rpm_in, rpm_arr, dph)
    water_flow = qh_in_val * n_fan * (delta_t_in / delta_t_base)

af_in = get_air_flow(rpm_in, version_sel, model_sel, p_stat)

# ==============================================================================
# 21) Output finale
# ==============================================================================
st.subheader("Risultati Finali")
if mode == "Cooling":
    st.write(f"**Resa Sensibile (Ps):** {ps_in_val:.2f} kW")
    st.write(f"**Resa Totale (Pc):** {pc_in_val:.2f} kW")
    st.write(f"**Resa Latente (Pc-Ps):** {lat_in_val:.2f} kW")
    st.write(f"**Potenza Assorbita (Pec):** {pec_in_val:.1f} W")
    st.write(f"**Perdita di Carico (DPc):** {dpc_in_val:.2f} kPa")
    st.write(f"**Portata Acqua:** {water_flow:.3f} m³/h")
    st.write(f"**Portata Aria:** {af_in:.1f} m³/h")
else:
    st.write(f"**Resa Totale (Ph):** {ph_in_val:.2f} kW")
    st.write(f"**Potenza Assorbita (PeH):** {peh_in_val:.1f} W")
    st.write(f"**Perdita di Carico (DPh):** {dph_in_val:.2f} kPa")
    st.write(f"**Portata Acqua:** {water_flow:.3f} m³/h")
    st.write(f"**Portata Aria:** {af_in:.1f} m³/h")

# ==============================================================================
# 22) Creazione di una tabella riassuntiva per i punti di test (Low/Med/High)
# ==============================================================================
op_points = rpm_arr.tolist()
rows_list = []
for r in op_points:
    vsp_r = safe_extrap_rpm(r, rpm_arr, vsp_arr)
    air_flow_val = get_air_flow(r, version_sel, model_sel, p_stat)
    row = {
        "Modello": f"{version_sel} {model_sel}",
        "RPM": f"{r:.0f}",
        "Vsp": f"{vsp_r:.2f}"
    }
    if mode == "Cooling":
        qc_r = safe_extrap_rpm(r, rpm_arr, qc)
        ps_r = safe_extrap_rpm(r, rpm_arr, ps)
        pc_r = safe_extrap_rpm(r, rpm_arr, pc)
        if pc_r < ps_r:
            pc_r = ps_r
        lat_r = pc_r - ps_r
        pec_r = safe_extrap_rpm(r, rpm_arr, pec)
        dpc_r = safe_extrap_rpm(r, rpm_arr, dpc)
        wf = qc_r * n_fan * (delta_t_in / delta_t_base)
        row["Portata Acqua"] = f"{wf:.1f} m³/h"
        row["Ps (kW)"] = f"{ps_r:.2f}"
        row["Pc (kW)"] = f"{pc_r:.2f}"
        row["Lat (kW)"] = f"{lat_r:.2f}"
        row["Pec (W)"] = f"{pec_r:.1f}"
        row["DPc (kPa)"] = f"{dpc_r:.2f}"
        row["Portata Aria"] = f"{air_flow_val:.1f} m³/h"
    else:
        qh_r = safe_extrap_rpm(r, rpm_arr, qh)
        ph_r = safe_extrap_rpm(r, rpm_arr, ph)
        peh_r = safe_extrap_rpm(r, rpm_arr, peh)
        dph_r = safe_extrap_rpm(r, rpm_arr, dph)
        wf = qh_r * n_fan * (delta_t_in / delta_t_base)
        row["Portata Acqua"] = f"{wf:.1f} m³/h"
        row["Ph (kW)"] = f"{ph_r:.2f}"
        row["PeH (W)"] = f"{peh_r:.1f}"
        row["DPh (kPa)"] = f"{dph_r:.2f}"
        row["Portata Aria"] = f"{air_flow_val:.1f} m³/h"
    rows_list.append(row)

df = pd.DataFrame(rows_list)
st.subheader(f"Tabella – Dati Interpolati ({mode})")
st.table(df)

# ==============================================================================
# 23) Grafico dei parametri vs. RPM
# ==============================================================================
rpm_plot = np.linspace(rpm_arr[0], rpm_arr[-1], 200)
af_plot = [get_air_flow(rr, version_sel, model_sel, p_stat) for rr in rpm_plot]

fig, axs = plt.subplots(3, 2, figsize=(14, 12))
axs[0,0].plot(rpm_plot, af_plot, 'b-', label="Portata Aria (m³/h)")
axs[0,0].set_xlabel("RPM")
axs[0,0].set_ylabel("Portata Aria (m³/h)")
axs[0,0].legend()

if mode == "Cooling":
    ps_plot = [safe_extrap_rpm(rr, rpm_arr, ps) for rr in rpm_plot]
    pc_plot = [safe_extrap_rpm(rr, rpm_arr, pc) for rr in rpm_plot]
    lat_plot = np.array(pc_plot) - np.array(ps_plot)
    pec_plot = [safe_extrap_rpm(rr, rpm_arr, pec) for rr in rpm_plot]
    dpc_plot = [safe_extrap_rpm(rr, rpm_arr, dpc) for rr in rpm_plot]
    qc_plot = [safe_extrap_rpm(rr, rpm_arr, qc) for rr in rpm_plot]
    
    axs[0,1].plot(rpm_plot, ps_plot, 'r-', label="Ps (kW)")
    axs[0,1].plot(rpm_plot, pc_plot, 'g-', label="Pc (kW)")
    axs[0,1].plot(rpm_plot, lat_plot, 'y-', label="Lat (Pc-Ps)")
    axs[0,1].set_xlabel("RPM")
    axs[0,1].set_ylabel("Resa (kW)")
    axs[0,1].legend()
    
    axs[1,0].plot(rpm_plot, dpc_plot, 'm-', label="DPc (kPa)")
    axs[1,0].set_xlabel("RPM")
    axs[1,0].set_ylabel("DPc (kPa)")
    axs[1,0].legend()
    
    axs[1,1].plot(rpm_plot, pec_plot, 'c-', label="Pec (W)")
    axs[1,1].set_xlabel("RPM")
    axs[1,1].set_ylabel("Consumo (W)")
    axs[1,1].legend()
    
    wf_plot = np.array(qc_plot) * n_fan * (delta_t_in / delta_t_base)
    axs[2,0].plot(rpm_plot, wf_plot, 'b-', label="Portata Acqua (m³/h)")
    axs[2,0].set_xlabel("RPM")
    axs[2,0].set_ylabel("Portata Acqua (m³/h)")
    axs[2,0].legend()
else:
    ph_plot = [safe_extrap_rpm(rr, rpm_arr, ph) for rr in rpm_plot]
    peh_plot = [safe_extrap_rpm(rr, rpm_arr, peh) for rr in rpm_plot]
    dph_plot = [safe_extrap_rpm(rr, rpm_arr, dph) for rr in rpm_plot]
    qh_plot = [safe_extrap_rpm(rr, rpm_arr, qh) for rr in rpm_plot]
    
    axs[0,1].plot(rpm_plot, ph_plot, 'r-', label="Ph (kW)")
    axs[0,1].set_xlabel("RPM")
    axs[0,1].set_ylabel("Resa (kW)")
    axs[0,1].legend()
    
    axs[1,0].plot(rpm_plot, dph_plot, 'm-', label="DPh (kPa)")
    axs[1,0].set_xlabel("RPM")
    axs[1,0].set_ylabel("DPh (kPa)")
    axs[1,0].legend()
    
    axs[1,1].plot(rpm_plot, peh_plot, 'c-', label="PeH (W)")
    axs[1,1].set_xlabel("RPM")
    axs[1,1].set_ylabel("Consumo (W)")
    axs[1,1].legend()
    
    wf_plot = np.array(qh_plot) * n_fan * (delta_t_in / delta_t_base)
    axs[2,0].plot(rpm_plot, wf_plot, 'b-', label="Portata Acqua (m³/h)")
    axs[2,0].set_xlabel("RPM")
    axs[2,0].set_ylabel("Portata Acqua (m³/h)")
    axs[2,0].legend()

axs[2,1].axis('off')
axs[2,1].text(0.1, 0.5, f"Modalità: {mode}\nΔT = {delta_t_in:.1f} °C", fontsize=14)

fig.suptitle(f"{mode} – Modello: {version_sel} {model_sel} (RPM={rpm_in:.0f})")
st.pyplot(fig)

st.markdown("""
**Note:**
- I dati del fancoil e delle curve ventilatore sono presi dai valori misurati.
- I valori di q_c e q_h sono in m³/h (quindi non si moltiplica per 3600).
- La portata aria è calcolata dalle curve (fan_curves) e corretta per la pressione statica.
- Il calcolo della portata acqua scala il valore in base al numero di ventilatori e al rapporto ΔT_in/ΔT_base.
""")
